# 第8卷 组合设计 (351-400)

---

## 第一部分 设计理论基础

### 问题 351
**题目描述**
设 $\mathcal{D} = (X, \mathcal{B})$ 是一个设计，其中 $X = \{1, 2, 3, 4, 5\}$，$\mathcal{B} = \{\{1,2\}, \{1,3\}, \{2,4\}, \{3,5\}, \{4,5\}\}$。求每个元素出现的次数。

**解答过程**
统计每个元素在区组中出现的次数：
- 元素1：出现在 $\{1,2\}, \{1,3\}$，共2次
- 元素2：出现在 $\{1,2\}, \{2,4\}$，共2次
- 元素3：出现在 $\{1,3\}, \{3,5\}$，共2次
- 元素4：出现在 $\{2,4\}, \{4,5\}$，共2次
- 元素5：出现在 $\{3,5\}, \{4,5\}$，共2次

**答案**
每个元素均出现2次。

---

### 问题 352
**题目描述**
在一个 $2$-$(v, k, \lambda)$ 设计中，证明：$\lambda(v-1) = r(k-1)$，其中 $r$ 是每点出现的区组数。

**解答过程**
考虑包含特定点 $x$ 的区组。这样的区组有 $r$ 个。
在每个这样的区组中，除 $x$ 外还有 $k-1$ 个点。
所以包含 $x$ 的区组中，其他位置的总数为 $r(k-1)$。
另一方面，对于每个其他点 $y \neq x$，包含 $\{x,y\}$ 的区组有 $\lambda$ 个。
共有 $v-1$ 个这样的 $y$，所以总数为 $\lambda(v-1)$。
因此 $\lambda(v-1) = r(k-1)$。

**答案**
$\lambda(v-1) = r(k-1)$，证毕。

---

### 问题 353
**题目描述**
在一个 $2$-$(16, 6, 2)$ 设计中，求区组数 $b$ 和每点出现的区组数 $r$。

**解答过程**
由基本方程：$\lambda(v-1) = r(k-1)$
$2(16-1) = r(6-1)$
$30 = 5r$，得 $r = 6$

由 $bk = vr$：
$b \times 6 = 16 \times 6$
$b = 16$

**答案**
$b = 16$，$r = 6$

---

### 问题 354
**题目描述**
证明：在一个对称的 $2$-$(v, k, \lambda)$ 设计中，任意两个不同的区组恰有 $\lambda$ 个公共点。

**解答过程**
在对称设计中，$b = v$ 且 $r = k$。
设 $B_i$ 和 $B_j$ 是两个不同的区组，$|B_i \cap B_j| = \mu$。
考虑关联矩阵 $A$（$v \times v$ 矩阵），其中 $A_{x,B} = 1$ 当且仅当 $x \in B$。
已知 $AA^T = (r-\lambda)I + \lambda J = (k-\lambda)I + \lambda J$。
对于对称设计，可以证明 $A^TA = AA^T$。
因此 $A^TA = (k-\lambda)I + \lambda J$，这意味着任意两个不同区组的内积为 $\lambda$。
即 $|B_i \cap B_j| = \lambda$。

**答案**
证毕

---

### 问题 355
**题目描述**
设 $\mathcal{D}$ 是一个 $2$-$(7, 3, 1)$ 设计（Fano平面的补设计）。求其参数。

**解答过程**
Fano平面是 $2$-$(7, 3, 1)$ 设计，有 $b = 7$ 个区组，$r = 3$。
补设计的区组是原设计区组的补集。
补设计参数：$v' = v = 7$，$k' = v - k = 4$，$\lambda'$ 需要计算。
在补设计中，两个点共有的区组数 = 总区组数 - 包含至少一个点的区组数 + 包含两点的区组数。
$\lambda' = b - 2r + \lambda = 7 - 6 + 1 = 2$

**答案**
$2$-$(7, 4, 2)$ 设计

---

### 问题 356
**题目描述**
在一个 $3$-$(v, k, \lambda)$ 设计中，证明：$\lambda_2 = \lambda \dfrac{v-2}{k-2}$，其中 $\lambda_2$ 是包含任意给定2-子集的区组数。

**解答过程**
考虑固定的2-子集 $S = \{x, y\}$。
包含 $S$ 的区组数为 $\lambda_2$。
对每个包含 $S$ 的区组，还可以选择 $k-2$ 个其他点。
考虑所有包含 $S$ 中某点的3-子集。
包含 $S$ 的3-子集有 $v-2$ 个（加入任意其他点）。
每个包含 $S$ 的区组包含 $\binom{k-2}{1} = k-2$ 个这样的3-子集（从 $k-2$ 个其他点中选1个）。
每个3-子集被 $\lambda$ 个区组包含。
所以 $\lambda(v-2) = \lambda_2(k-2)$，即 $\lambda_2 = \lambda \dfrac{v-2}{k-2}$。

**答案**
$\lambda_2 = \lambda \dfrac{v-2}{k-2}$，证毕。

---

### 问题 357
**题目描述**
构造一个 $2$-$(6, 3, 2)$ 设计。

**解答过程**
参数：$v = 6, k = 3, \lambda = 2$
由 $\lambda(v-1) = r(k-1)$：$2 \times 5 = r \times 2$，得 $r = 5$
由 $bk = vr$：$3b = 6 \times 5 = 30$，得 $b = 10$

取 $X = \{1, 2, 3, 4, 5, 6\}$，构造10个区组：
$\{1,2,3\}, \{1,2,4\}, \{1,3,5\}, \{1,4,6\}, \{1,5,6\},$
$\{2,3,6\}, \{2,4,5\}, \{2,5,6\}, \{3,4,5\}, \{3,4,6\}$

验证：每对点恰出现在2个区组中。

**答案**
区组为：$\{1,2,3\}, \{1,2,4\}, \{1,3,5\}, \{1,4,6\}, \{1,5,6\}, \{2,3,6\}, \{2,4,5\}, \{2,5,6\}, \{3,4,5\}, \{3,4,6\}$

---

### 问题 358
**题目描述**
证明：若存在 $2$-$(v, k, \lambda)$ 设计，则 $\lambda(v-1) \equiv 0 \pmod{k-1}$。

**解答过程**
由基本方程：$r = \dfrac{\lambda(v-1)}{k-1}$
因为 $r$ 必须是整数（每点出现的区组数），
所以 $\dfrac{\lambda(v-1)}{k-1}$ 是整数。
即 $\lambda(v-1) \equiv 0 \pmod{k-1}$。

**答案**
证毕

---

### 问题 359
**题目描述**
在一个 $2$-$(13, 4, 1)$ 设计中，求区组数 $b$。

**解答过程**
由 $\lambda(v-1) = r(k-1)$：
$1 \times 12 = r \times 3$，得 $r = 4$

由 $bk = vr$：
$4b = 13 \times 4 = 52$
$b = 13$

这是一个对称设计（$b = v = 13$）。

**答案**
$b = 13$

---

### 问题 360
**题目描述**
设 $\mathcal{D}_1 = (X, \mathcal{B}_1)$ 和 $\mathcal{D}_2 = (X, \mathcal{B}_2)$ 是同一集合 $X$ 上的两个设计。定义它们的并设计。若 $\mathcal{D}_1$ 是 $2$-$(v, k, \lambda_1)$，$\mathcal{D}_2$ 是 $2$-$(v, k, \lambda_2)$，则并设计是什么参数？

**解答过程**
并设计 $\mathcal{D} = (X, \mathcal{B}_1 \cup \mathcal{B}_2)$（多重集并）。
对任意2-子集 $\{x, y\} \subseteq X$，
在 $\mathcal{D}_1$ 中被 $\lambda_1$ 个区组包含，
在 $\mathcal{D}_2$ 中被 $\lambda_2$ 个区组包含。
在并设计中被 $\lambda_1 + \lambda_2$ 个区组包含。
所以并设计是 $2$-$(v, k, \lambda_1 + \lambda_2)$。

**答案**
$2$-$(v, k, \lambda_1 + \lambda_2)$ 设计

---

## 第二部分 拉丁方

### 问题 361
**题目描述**
写出所有 $2 \times 2$ 的拉丁方。

**解答过程**
$2 \times 2$ 拉丁方使用符号 $\{1, 2\}$，要求每行每列都是这两个符号的排列。

第一个拉丁方：
$$\begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix}$$

第二个拉丁方（交换符号1和2）：
$$\begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}$$

这是仅有的两个 $2 \times 2$ 拉丁方（同构意义下只有1个）。

**答案**
$\begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix}$ 和 $\begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}$

---

### 问题 362
**题目描述**
构造一个 $3 \times 3$ 的拉丁方。

**解答过程**
使用循环构造法：$L_{ij} = (i + j) \mod 3 + 1$

$$L = \begin{pmatrix} 
2 & 3 & 1 \\
3 & 1 & 2 \\
1 & 2 & 3
\end{pmatrix}$$

验证：每行是 $\{1, 2, 3\}$ 的排列，每列也是。

**答案**
$$\begin{pmatrix} 2 & 3 & 1 \\ 3 & 1 & 2 \\ 1 & 2 & 3 \end{pmatrix}$$

---

### 问题 363
**题目描述**
两个 $n \times n$ 拉丁方 $L_1$ 和 $L_2$ 称为正交的，若对所有 $(i, j)$，有序对 $(L_1(i,j), L_2(i,j))$ 互不相同。
证明：不存在两个正交的 $2 \times 2$ 拉丁方。

**解答过程**
标准化 $2 \times 2$ 拉丁方（第一行第一列为1）：
$$L_1 = \begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix}$$

另一个拉丁方只能是：
$$L_2 = \begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix} \text{ 或 } \begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}$$

若 $L_2 = L_1$，则 $(1,1)$ 出现两次，不正交。
若 $L_2 = \begin{pmatrix} 2 & 1 \\ 1 & 2 \end{pmatrix}$，有序对为 $(1,2), (2,1), (2,1), (1,2)$，$(1,2)$ 和 $(2,1)$ 各出现两次。

所以不存在正交对。

**答案**
证毕

---

### 问题 364
**题目描述**
构造一对正交的 $3 \times 3$ 拉丁方（MOLS）。

**解答过程**
第一个拉丁方（加法表模3）：
$$L_1 = \begin{pmatrix} 1 & 2 & 3 \\ 2 & 3 & 1 \\ 3 & 1 & 2 \end{pmatrix}$$

第二个拉丁方（使用乘法生成）：
$$L_2 = \begin{pmatrix} 1 & 2 & 3 \\ 3 & 1 & 2 \\ 2 & 3 & 1 \end{pmatrix}$$

验证正交性：9个有序对 $(L_1(i,j), L_2(i,j))$：
$(1,1), (2,2), (3,3), (2,3), (3,1), (1,2), (3,2), (1,3), (2,1)$
都是不同的。

**答案**
$L_1 = \begin{pmatrix} 1 & 2 & 3 \\ 2 & 3 & 1 \\ 3 & 1 & 2 \end{pmatrix}$，$L_2 = \begin{pmatrix} 1 & 2 & 3 \\ 3 & 1 & 2 \\ 2 & 3 & 1 \end{pmatrix}$

---

### 问题 365
**题目描述**
证明：$n-1$ 个两两正交的 $n \times n$ 拉丁方（MOLS）的集合是最大的。

**解答过程**
设有 $m$ 个 MOLS $L_1, L_2, \ldots, L_m$。
不失一般性，假设都标准化（第一行为 $1, 2, \ldots, n$）。

考虑位置 $(2, 1)$ 处的值。
对每个 $L_k$，$L_k(2,1) \neq 1$（因为第一列已有1在第一行）。
所以 $L_k(2,1) \in \{2, 3, \ldots, n\}$。

对 $k \neq l$，$(L_k(2,1), L_l(2,1)) \neq (1,1)$（因为第一行第一列是 $(1,1)$）。
实际上，由于第一行都是 $(i, i)$ 形式，所以 $(L_k(2,1), L_l(2,1)) \neq (i, i)$ 对任意 $i$。
即 $L_k(2,1) \neq L_l(2,1)$。

所以 $m$ 个值 $L_1(2,1), \ldots, L_m(2,1)$ 是 $\{2, \ldots, n\}$ 中互不相同的数。
因此 $m \leq n-1$。

**答案**
证毕

---

### 问题 366
**题目描述**
构造一个 $4 \times 4$ 拉丁方。

**解答过程**
使用有限域 $\mathbb{F}_4 = \{0, 1, \alpha, \alpha+1\}$，其中 $\alpha^2 = \alpha + 1$。
加法表：

$$\begin{pmatrix} 
0 & 1 & \alpha & \alpha+1 \\
1 & 0 & \alpha+1 & \alpha \\
\alpha & \alpha+1 & 0 & 1 \\
\alpha+1 & \alpha & 1 & 0
\end{pmatrix}$$

映射 $0 \to 1, 1 \to 2, \alpha \to 3, \alpha+1 \to 4$：

$$\begin{pmatrix} 
1 & 2 & 3 & 4 \\
2 & 1 & 4 & 3 \\
3 & 4 & 1 & 2 \\
4 & 3 & 2 & 1
\end{pmatrix}$$

**答案**
$$\begin{pmatrix} 1 & 2 & 3 & 4 \\ 2 & 1 & 4 & 3 \\ 3 & 4 & 1 & 2 \\ 4 & 3 & 2 & 1 \end{pmatrix}$$

---

### 问题 367
**题目描述**
证明：若 $n$ 是素数幂，则存在 $n-1$ 个 MOLS。

**解答过程**
设 $\mathbb{F}_n$ 是有 $n$ 个元素的有限域，$n = p^k$。
对 $a \in \mathbb{F}_n^*$（非零元），定义拉丁方 $L_a$：
$$L_a(i, j) = a \cdot i + j$$
其中 $i, j \in \mathbb{F}_n$。

验证这是拉丁方：固定 $i$，$j$ 遍历所有值，$L_a(i,j)$ 遍历所有值。
固定 $j$，$i$ 遍历所有值，$a \cdot i + j$ 遍历所有值（$a \neq 0$）。

正交性：对 $a \neq b$，设 $L_a(i,j) = L_a(i',j')$ 且 $L_b(i,j) = L_b(i',j')$。
即 $ai + j = ai' + j'$ 和 $bi + j = bi' + j'$。
相减：$(a-b)i = (a-b)i'$，所以 $i = i'$，进而 $j = j'$。
所以 $(L_a(i,j), L_b(i,j))$ 都是不同的。

共有 $n-1$ 个非零元，所以存在 $n-1$ 个 MOLS。

**答案**
证毕

---

### 问题 368
**题目描述**
构造3个两两正交的 $4 \times 4$ 拉丁方。

**解答过程**
使用 $\mathbb{F}_4 = \{0, 1, \alpha, \alpha+1\}$，非零元为 $1, \alpha, \alpha+1$。

$L_1$（$a=1$）：
$$\begin{pmatrix} 1 & 2 & 3 & 4 \\ 2 & 1 & 4 & 3 \\ 3 & 4 & 1 & 2 \\ 4 & 3 & 2 & 1 \end{pmatrix}$$

$L_2$（$a=\alpha$，映射后）：
$$\begin{pmatrix} 1 & 2 & 3 & 4 \\ 3 & 4 & 1 & 2 \\ 4 & 3 & 2 & 1 \\ 2 & 1 & 4 & 3 \end{pmatrix}$$

$L_3$（$a=\alpha+1$）：
$$\begin{pmatrix} 1 & 2 & 3 & 4 \\ 4 & 3 & 2 & 1 \\ 2 & 1 & 4 & 3 \\ 3 & 4 & 1 & 2 \end{pmatrix}$$

**答案**
三个MOLS如上所示

---

### 问题 369
**题目描述**
计算 $5 \times 5$ 拉丁方的个数（不考虑同构）。

**解答过程**
$5 \times 5$ 拉丁方的总数是已知的：
约化拉丁方（第一行第一列标准化）的数量是 $56$。
每个约化拉丁方可通过行、列、符号的排列得到 $(5!)^2 \times 4! = 14400 \times 24 = 345600$ 个拉丁方。
（注意：对于 $n \geq 2$，行列符号排列产生不同的拉丁方）

总数 $= 56 \times 14400 = 806400$。

**答案**
$5 \times 5$ 拉丁方共有 $1,612,800,000$ 个（最新计算结果）

---

### 问题 370
**题目描述**
证明：拉丁方的横截（transversal）是指包含每个符号恰好一次的 $n$ 个位置的集合，且这些位置在不同行不同列。
证明：若拉丁方有正交伴侣，则它必须有横截。

**解答过程**
设 $L_1$ 和 $L_2$ 是正交拉丁方。
考虑 $L_2$ 中符号1出现的位置：$(1, c_1), (2, c_2), \ldots, (n, c_n)$。
这些位置在不同行（显然）和不同列（因为 $L_2$ 每列每个符号只出现一次）。
在 $L_1$ 的这些位置上，值分别是 $L_1(1, c_1), \ldots, L_1(n, c_n)$。
由于正交性，$L_2 = 1$ 的位置在 $L_1$ 上必须取遍所有符号（否则某有序对重复）。
所以这些位置形成 $L_1$ 的一个横截。

**答案**
证毕

---

### 问题 371
**题目描述**
构造一个 $5 \times 5$ 拉丁方。

**解答过程**
使用循环移位：

$$L = \begin{pmatrix} 
1 & 2 & 3 & 4 & 5 \\
2 & 3 & 4 & 5 & 1 \\
3 & 4 & 5 & 1 & 2 \\
4 & 5 & 1 & 2 & 3 \\
5 & 1 & 2 & 3 & 4
\end{pmatrix}$$

这是循环拉丁方。

**答案**
如上所示

---

### 问题 372
**题目描述**
设 $L$ 是一个 $n \times n$ 拉丁方。定义 $L$ 的转置 $L^T$。证明 $L^T$ 也是拉丁方。$L$ 和 $L^T$ 何时正交？

**解答过程**
$L^T(i,j) = L(j,i)$。
固定 $i$，$L^T(i, j) = L(j, i)$，$j$ 从1到 $n$，这是 $L$ 的第 $i$ 列，包含每个符号恰好一次。
固定 $j$，$L^T(i, j) = L(j, i)$，$i$ 从1到 $n$，这是 $L$ 的第 $j$ 行，包含每个符号恰好一次。
所以 $L^T$ 是拉丁方。

$L$ 和 $L^T$ 正交当且仅当对所有 $i \neq i'$ 或 $j \neq j'$，
$(L(i,j), L(j,i)) \neq (L(i',j'), L(j',i'))$。
这要求 $L$ 是自正交的（self-orthogonal）。

**答案**
$L^T$ 是拉丁方；$L$ 和 $L^T$ 正交当且仅当 $L$ 是自正交的。

---

### 问题 373
**题目描述**
证明：不存在 $6 \times 6$ 的正交拉丁方对（Euler三十六军官问题）。

**解答过程**
这是Tarry在1901年通过穷举证明的。
关键思路：假设存在这样的正交对，则可以通过适当的行列置换标准化。
经过系统搜索，可以证明不存在满足条件的配置。

更现代的证明涉及Bruck-Ryser定理：对 $n \equiv 2 \pmod 4$，若存在MOLS，则 $n$ 必须可以表示为两个平方数之和。
$6 = 2 \times 3$，$6 \equiv 2 \pmod 4$，但 $6$ 不是两个平方数之和（$6 = 1+5$ 但5不是平方，$6 = 4+2$ 但2不是平方）。

**答案**
证毕（Tarry, 1901）

---

### 问题 374
**题目描述**
构造一个 $7 \times 7$ 的拉丁方。

**解答过程**
使用 $\mathbb{Z}_7$ 的加法表：

$$L = \begin{pmatrix} 
1 & 2 & 3 & 4 & 5 & 6 & 7 \\
2 & 3 & 4 & 5 & 6 & 7 & 1 \\
3 & 4 & 5 & 6 & 7 & 1 & 2 \\
4 & 5 & 6 & 7 & 1 & 2 & 3 \\
5 & 6 & 7 & 1 & 2 & 3 & 4 \\
6 & 7 & 1 & 2 & 3 & 4 & 5 \\
7 & 1 & 2 & 3 & 4 & 5 & 6
\end{pmatrix}$$

**答案**
如上所示

---

### 问题 375
**题目描述**
证明：对素数 $p$，存在 $p-1$ 个两两正交的 $p \times p$ 拉丁方。

**解答过程**
设 $\mathbb{F}_p = \{0, 1, \ldots, p-1\}$ 是模 $p$ 的域。
对 $a \in \{1, 2, \ldots, p-1\}$，定义 $L_a(i, j) = (ai + j) \mod p + 1$。

验证拉丁方：固定 $i$，$j$ 变化时 $ai + j$ 遍历所有余数。
固定 $j$，$i$ 变化时 $ai + j$ 遍历所有余数（$a \neq 0$）。

正交性：设 $(L_a(i,j), L_b(i,j)) = (L_a(i',j'), L_b(i',j'))$，$a \neq b$。
则 $ai + j \equiv ai' + j'$ 且 $bi + j \equiv bi' + j' \pmod p$。
相减：$(a-b)i \equiv (a-b)i' \pmod p$。
因 $a \neq b$，$a-b$ 可逆，所以 $i \equiv i'$，进而 $j \equiv j'$。
所以有序对互不相同。

**答案**
证毕

---

## 第三部分 正交数组

### 问题 376
**题目描述**
什么是正交数组 $OA(N, k, s, t)$？解释各参数的含义。

**解答过程**
正交数组 $OA(N, k, s, t)$ 是一个 $N \times k$ 矩阵，元素取自 $s$ 元符号集，满足：
对任意 $t$ 列，每个可能的 $t$ 元组作为行出现恰好 $\lambda = N/s^t$ 次。

参数含义：
- $N$：试验次数（行数）
- $k$：因素数（列数）
- $s$：每个因素的水平数
- $t$：强度
- $\lambda$：索引

**答案**
$OA(N, k, s, t)$ 是 $N \times k$ 矩阵，任意 $t$ 列包含所有 $s^t$ 个 $t$ 元组各 $\lambda = N/s^t$ 次。

---

### 问题 377
**题目描述**
构造一个 $OA(4, 3, 2, 2)$。

**解答过程**
$N = 4, k = 3, s = 2, t = 2$，$\lambda = 4/4 = 1$。
需要4行3列，元素取自 $\{0, 1\}$，任意2列包含所有4个二元组各1次。

$$\begin{pmatrix} 
0 & 0 & 0 \\
0 & 1 & 1 \\
1 & 0 & 1 \\
1 & 1 & 0
\end{pmatrix}$$

验证列1和列2：$(0,0), (0,1), (1,0), (1,1)$ 各1次。
列1和列3：$(0,0), (0,1), (1,1), (1,0)$ 各1次。
列2和列3：$(0,0), (1,1), (0,1), (1,0)$ 各1次。

**答案**
$$\begin{pmatrix} 0 & 0 & 0 \\ 0 & 1 & 1 \\ 1 & 0 & 1 \\ 1 & 1 & 0 \end{pmatrix}$$

---

### 问题 378
**题目描述**
证明：从 $m$ 个 MOLS 可以构造 $OA(mn^2, m+2, n, 2)$。

**解答过程**
设 $L_1, \ldots, L_m$ 是 $n \times n$ MOLS。
构造 $OA$ 有 $m+2$ 列：前两列和所有 $L_i$。
行对应 $(i, j)$ 对，$i, j \in \{1, \ldots, n\}$。
对位置 $(i, j)$，行是 $(i, j, L_1(i,j), L_2(i,j), \ldots, L_m(i,j))$。
共 $n^2$ 行，但我们可能需要 $m$ 个副本？

实际上标准构造：对 MOLS $L_1, \ldots, L_m$，构造 $OA$ 如下：
行索引 $(r, c)$，$r, c \in \{0, \ldots, n-1\}$。
第1列：$r$
第2列：$c$
第 $k+2$ 列：$L_k(r, c)$

这是 $OA(n^2, m+2, n, 2)$，不是 $OA(mn^2, \ldots)$。

重新理解：实际上标准结果是 $m$ 个 $n \times n$ MOLS 给出 $OA(n^2, m+2, n, 2)$。

**答案**
从 $m$ 个 $n \times n$ MOLS 可构造 $OA(n^2, m+2, n, 2)$

---

### 问题 379
**题目描述**
证明：若存在 $OA(N, k, s, t)$，则存在 $OA(N, k-1, s, t)$。

**解答过程**
$OA(N, k, s, t)$ 是 $N \times k$ 矩阵，任意 $t$ 列有性质 $P$。
删除任一列，得到 $N \times (k-1)$ 矩阵。
任意 $t$ 列在新矩阵中：
- 若都不包含被删除的列，则这 $t$ 列在原数组中也有性质 $P$。
- 所以新数组也是正交数组，强度仍为 $t$。

**答案**
证毕（通过删除一列）

---

### 问题 380
**题目描述**
构造一个 $OA(8, 4, 2, 3)$。

**解答过程**
$N = 8, k = 4, s = 2, t = 3$，$\lambda = 8/8 = 1$。
这是 $2^3$ 设计的全因子试验。

$$\begin{pmatrix} 
0 & 0 & 0 & 0 \\
0 & 0 & 1 & 1 \\
0 & 1 & 0 & 1 \\
0 & 1 & 1 & 0 \\
1 & 0 & 0 & 1 \\
1 & 0 & 1 & 0 \\
1 & 1 & 0 & 0 \\
1 & 1 & 1 & 1
\end{pmatrix}$$

其中第4列 = 第1列 $\oplus$ 第2列 $\oplus$ 第3列（异或）。

**答案**
如上所示

---

### 问题 381
**题目描述**
证明：$OA(N, k, s, t)$ 存在的一个必要条件是 $N \equiv 0 \pmod{s^t}$。

**解答过程**
在 $OA(N, k, s, t)$ 中，任意 $t$ 列必须包含所有 $s^t$ 个可能的 $t$ 元组各 $\lambda$ 次。
所以 $N = \lambda \cdot s^t$。
因此 $s^t$ 整除 $N$。

**答案**
证毕

---

### 问题 382
**题目描述**
什么是线性正交数组？

**解答过程**
设 $\mathbb{F}_q$ 是有限域。线性正交数组 $OA(q^t, k, q, t)$ 是 $\mathbb{F}_q$ 上的 $q^t \times k$ 矩阵，其行构成 $\mathbb{F}_q^k$ 的一个 $t$ 维子空间（或更一般地，线性码的陪集）。

等价地，线性 $OA$ 可以看作是所有线性映射 $f: \mathbb{F}_q^t \to \mathbb{F}_q^k$ 的像，满足特定条件。
标准构造：取一个 $t \times k$ 生成矩阵 $G$，行是所有 $u \cdot G$，$u \in \mathbb{F}_q^t$。

**答案**
行构成 $\mathbb{F}_q$ 上向量子空间的正交数组称为线性的。

---

### 问题 383
**题目描述**
构造 $OA(9, 4, 3, 2)$。

**解答过程**
$N = 9, k = 4, s = 3, t = 2$，$\lambda = 9/9 = 1$。
使用两个 MOLS(3) 的构造：

行对应 $(r, c)$，$r, c \in \{0, 1, 2\}$：
- 列1：$r$
- 列2：$c$
- 列3：$r + c \pmod 3$
- 列4：$r + 2c \pmod 3$

$$\begin{pmatrix} 
0 & 0 & 0 & 0 \\
0 & 1 & 1 & 2 \\
0 & 2 & 2 & 1 \\
1 & 0 & 1 & 1 \\
1 & 1 & 2 & 0 \\
1 & 2 & 0 & 2 \\
2 & 0 & 2 & 2 \\
2 & 1 & 0 & 1 \\
2 & 2 & 1 & 0
\end{pmatrix}$$

**答案**
如上所示

---

### 问题 384
**题目描述**
证明：$OA(N, k, s, t)$ 与 $k$ 个 $s$ 水平的因素的全因子设计的分辨度有关。

**解答过程**
在试验设计中，分辨度 $R$ 是指：没有任何 $R-1$ 个因素的效应与任何其他因素效应混杂。
正交数组的强度 $t$ 与分辨度 $R = t + 1$ 相关。

具体地，$OA(N, k, s, t)$ 对应一个分辨度 $t+1$ 的分数因子设计。
例如，$OA(8, 4, 2, 3)$ 对应 $2^{4-1}$ 设计，分辨度 IV（因为 $t+1 = 4$）。

**答案**
$OA(N, k, s, t)$ 对应分辨度 $R = t+1$ 的分数因子设计。

---

### 问题 385
**题目描述**
计算 $OA(16, 5, 2, 3)$ 中的行数是否满足必要条件。

**解答过程**
必要条件：$N \equiv 0 \pmod{s^t} = 0 \pmod{2^3} = 0 \pmod 8$。
$16 \equiv 0 \pmod 8$，满足。

另一个条件：$k \leq \dfrac{N-1}{s-1} = \dfrac{15}{1} = 15$（对 $t=2$ 的Rao界）。
对 $t=3$：$N \geq s^t = 8$，$k$ 的上界更复杂。

实际上 $OA(16, 5, 2, 3)$ 存在（来自 $2^{5-1}$ 设计的半复制）。

**答案**
满足，$16$ 是 $8$ 的倍数。

---

## 第四部分 区组设计

### 问题 386
**题目描述**
什么是平衡不完全区组设计（BIBD）？

**解答过程**
BIBD 是一个二元组 $(X, \mathcal{B})$，其中：
- $X$ 是 $v$ 个点的集合
- $\mathcal{B}$ 是 $b$ 个区组的集合，每个区组是 $k$ 个点的子集
满足：
1. 每对点恰好同时出现在 $\lambda$ 个区组中
2. $k < v$（不完全）

参数记为 $2$-$(v, k, \lambda)$ 或 $(v, b, r, k, \lambda)$，其中 $r$ 是每点出现的区组数。

**答案**
BIBD是 $2$-$(v, k, \lambda)$ 设计，满足每对点恰在 $\lambda$ 个区组中，$k < v$。

---

### 问题 387
**题目描述**
证明Fano平面是 $2$-$(7, 3, 1)$ 设计。

**解答过程**
Fano平面：$X = \{1, 2, 3, 4, 5, 6, 7\}$
区组（直线）：
$\{1,2,3\}, \{1,4,5\}, \{1,6,7\}, \{2,4,6\}, \{2,5,7\}, \{3,4,7\}, \{3,5,6\}$

验证：
- $v = 7, k = 3$
- 区组数 $b = 7$
- 每点出现 $r = 3$ 次
- 检查每对点：如 $\{1,2\}$ 只在 $\{1,2,3\}$ 中，$\lambda = 1$
  类似验证所有 $\binom{7}{2} = 21$ 对点。

**答案**
Fano平面是 $2$-$(7, 3, 1)$ 设计，证毕。

---

### 问题 388
**题目描述**
在一个 $(v, b, r, k, \lambda)$-设计中，证明 $vr = bk$。

**解答过程**
计算所有区组中点的出现次数之和（计重）。
方法一：每个点出现在 $r$ 个区组中，共 $v$ 个点，所以总和 $= vr$。
方法二：每个区组有 $k$ 个点，共 $b$ 个区组，所以总和 $= bk$。
因此 $vr = bk$。

**答案**
证毕

---

### 问题 389
**题目描述**
构造一个 $2$-$(9, 3, 1)$ 设计（仿射平面阶数3）。

**解答过程**
仿射平面 $AG(2, 3)$：点是 $\mathbb{F}_3^2$ 的元素 $(x, y)$，共9个点。
区组是直线：满足 $ax + by = c$ 的点集，$(a, b) \neq (0, 0)$。

点：$(0,0), (0,1), (0,2), (1,0), (1,1), (1,2), (2,0), (2,1), (2,2)$

平行类（斜率）：
垂直：$\{(0,0),(0,1),(0,2)\}, \{(1,0),(1,1),(1,2)\}, \{(2,0),(2,1),(2,2)\}$
水平：$\{(0,0),(1,0),(2,0)\}, \{(0,1),(1,1),(2,1)\}, \{(0,2),(1,2),(2,2)\}$
斜率1：$\{(0,0),(1,1),(2,2)\}, \{(0,1),(1,2),(2,0)\}, \{(0,2),(1,0),(2,1)\}$
斜率2：$\{(0,0),(1,2),(2,1)\}, \{(0,1),(1,0),(2,2)\}, \{(0,2),(1,1),(2,0)\}$

共12个区组，$b = 12$，$r = 4$，$\lambda = 1$。

**答案**
如上所列12个区组

---

### 问题 390
**题目描述**
证明：在一个对称设计（$b = v$）中，$r = k$。

**解答过程**
由 $vr = bk$，若 $b = v$，则 $vr = vk$，所以 $r = k$。

**答案**
证毕

---

### 问题 391
**题目描述**
什么是可分解设计？证明 $2$-$(9, 3, 1)$ 是可分解的。

**解答过程**
可分解设计是指区组可以划分为平行类，每个平行类是点集的一个划分。

对 $2$-$(9, 3, 1)$（仿射平面 $AG(2,3)$）：
12个区组分为4个平行类，每类3个区组：
- 平行类1（垂直）：$\{(0,0),(0,1),(0,2)\}, \{(1,0),(1,1),(1,2)\}, \{(2,0),(2,1),(2,2)\}$
- 平行类2（水平）：$\{(0,0),(1,0),(2,0)\}, \{(0,1),(1,1),(2,1)\}, \{(0,2),(1,2),(2,2)\}$
- 平行类3（斜率1）：$\{(0,0),(1,1),(2,2)\}, \{(0,1),(1,2),(2,0)\}, \{(0,2),(1,0),(2,1)\}$
- 平行类4（斜率2）：$\{(0,0),(1,2),(2,1)\}, \{(0,1),(1,0),(2,2)\}, \{(0,2),(1,1),(2,0)\}$

每个平行类的3个区组互不相交，覆盖全部9个点。

**答案**
证毕，$AG(2,3)$ 可分解为4个平行类。

---

### 问题 392
**题目描述**
计算 $2$-$(15, 3, 1)$ 设计的参数 $b$ 和 $r$。

**解答过程**
$\lambda(v-1) = r(k-1)$
$1 \times 14 = r \times 2$，得 $r = 7$

$bk = vr$
$3b = 15 \times 7 = 105$
$b = 35$

**答案**
$b = 35$，$r = 7$

---

### 问题 393
**题目描述**
证明：若 $v$ 是偶数且存在对称 $2$-$(v, k, \lambda)$ 设计，则 $k - \lambda$ 是完全平方数。

**解答过程**
对对称设计，关联矩阵 $A$ 满足 $AA^T = (k-\lambda)I + \lambda J$。
$\det(AA^T) = \det(A)^2$ 必须是完全平方数。

$\det((k-\lambda)I + \lambda J) = (k-\lambda)^{v-1}(k + (v-1)\lambda)$
由对称设计方程 $k(k-1) = \lambda(v-1)$，所以 $k + (v-1)\lambda = k + k(k-1) = k^2$。

所以 $\det(AA^T) = (k-\lambda)^{v-1} \cdot k^2$。
这是完全平方数当且仅当 $(k-\lambda)^{v-1}$ 是完全平方数。
若 $v$ 是偶数，则 $v-1$ 是奇数，所以 $k-\lambda$ 必须是完全平方数。

**答案**
证毕（Bruck-Ryser-Chowla定理的一部分）

---

### 问题 394
**题目描述**
什么是差集？如何用差集构造对称设计？

**解答过程**
$(v, k, \lambda)$-差集是群 $G$（$|G| = v$）的 $k$ 元子集 $D$，使得每个非单位元 $g \in G$ 恰有 $\lambda$ 种方式表示为 $d_1 d_2^{-1}$，$d_1, d_2 \in D$。

构造设计：点是群元素 $G$，区组是 $D$ 的平移 $\{Dg : g \in G\}$。
这是一个对称 $2$-$(v, k, \lambda)$ 设计。

验证：点 $x$ 和 $y$ 同时在区组 $Dg$ 中当且仅当 $xg^{-1}, yg^{-1} \in D$。
即 $xy^{-1} = (xg^{-1})(yg^{-1})^{-1}$，恰有 $\lambda$ 个 $g$ 满足。

**答案**
$(v, k, \lambda)$-差集给出对称 $2$-$(v, k, \lambda)$ 设计。

---

### 问题 395
**题目描述**
构造 $(7, 3, 1)$-差集并导出Fano平面。

**解答过程**
在 $\mathbb{Z}_7$ 中，$D = \{0, 1, 3\}$ 是 $(7, 3, 1)$-差集。
差值（模7）：
$0-1=6, 0-3=4, 1-0=1, 1-3=5, 3-0=3, 3-1=2$
即 $\{1, 2, 3, 4, 5, 6\}$，每个非零元恰出现1次。

平移得到7个区组：
$D + 0 = \{0, 1, 3\}$
$D + 1 = \{1, 2, 4\}$
$D + 2 = \{2, 3, 5\}$
$D + 3 = \{3, 4, 6\}$
$D + 4 = \{4, 5, 0\}$
$D + 5 = \{5, 6, 1\}$
$D + 6 = \{6, 0, 2\}$

映射 $i \to i+1$ 得到标准Fano平面。

**答案**
$D = \{0, 1, 3\}$，平移得到Fano平面的7个区组。

---

## 第五部分 斯坦纳系统

### 问题 396
**题目描述**
什么是Steiner系统 $S(t, k, v)$？

**解答过程**
Steiner系统 $S(t, k, v)$ 是一个 $t$-$(v, k, 1)$ 设计。
即 $v$ 元集上的区组集合，每个区组大小为 $k$，满足：
每 $t$ 个点的子集恰被包含在1个区组中。

特例：
- $S(2, 3, v)$ 称为Steiner三元系（STS）
- $S(3, 4, v)$ 称为Steiner四元系（SQS）
- $S(5, 6, 12)$ 和 $S(5, 8, 24)$ 是Mathieu群相关的著名设计

**答案**
$S(t, k, v)$ 是 $t$-$(v, k, 1)$ 设计，每 $t$ 点子集恰在1个区组中。

---

### 问题 397
**题目描述**
证明：Steiner三元系 $S(2, 3, v)$ 存在的必要条件是 $v \equiv 1 \text{ 或 } 3 \pmod 6$。

**解答过程**
STS是 $2$-$(v, 3, 1)$ 设计。
必要条件：
1. $r = \dfrac{\lambda(v-1)}{k-1} = \dfrac{v-1}{2}$ 是整数，所以 $v$ 是奇数。
2. $b = \dfrac{vr}{k} = \dfrac{v(v-1)}{6}$ 是整数，所以 $v(v-1) \equiv 0 \pmod 6$。

$v$ 奇数且 $v(v-1) \equiv 0 \pmod 6$：
- $v \equiv 0 \pmod 3$ 且 $v$ 奇数 $\Rightarrow v \equiv 3 \pmod 6$
- $v \equiv 1 \pmod 3$ 且 $v$ 奇数 $\Rightarrow v \equiv 1 \pmod 6$

所以 $v \equiv 1$ 或 $3 \pmod 6$。

**答案**
证毕

---

### 问题 398
**题目描述**
构造Steiner三元系 $S(2, 3, 7)$（Fano平面）。

**解答过程**
$v = 7, k = 3, \lambda = 1$。
这是Fano平面，有 $b = \dfrac{7 \times 6}{6} = 7$ 个区组（三元组）。

区组：
$\{1,2,3\}, \{1,4,5\}, \{1,6,7\}, \{2,4,6\}, \{2,5,7\}, \{3,4,7\}, \{3,5,6\}$

验证：任意两点恰在一个区组中。
例如1和2：在 $\{1,2,3\}$；1和4：在 $\{1,4,5\}$；4和7：在 $\{3,4,7\}$。

**答案**
如上所列7个三元组

---

### 问题 399
**题目描述**
构造Steiner三元系 $S(2, 3, 9)$。

**解答过程**
$v = 9, b = \dfrac{9 \times 8}{6} = 12$ 个区组。
使用 $AG(2, 3)$ 的直线：

$X = \mathbb{F}_3 \times \mathbb{F}_3 = \{(i,j) : i, j \in \{0,1,2\}\}$

区组（直线）：
垂直：$\{(0,0),(0,1),(0,2)\}, \{(1,0),(1,1),(1,2)\}, \{(2,0),(2,1),(2,2)\}$
水平：$\{(0,0),(1,0),(2,0)\}, \{(0,1),(1,1),(2,1)\}, \{(0,2),(1,2),(2,2)\}$
斜率1：$\{(0,0),(1,1),(2,2)\}, \{(0,1),(1,2),(2,0)\}, \{(0,2),(1,0),(2,1)\}$
斜率2：$\{(0,0),(1,2),(2,1)\}, \{(0,1),(1,0),(2,2)\}, \{(0,2),(1,1),(2,0)\}$

**答案**
如上所列12个三元组

---

### 问题 400
**题目描述**
什么是Witt设计？简述 $S(5, 6, 12)$ 和 $S(5, 8, 24)$ 的重要性。

**解答过程**
Witt设计是两个特殊的Steiner系统：
- $S(5, 6, 12)$：12点，六元区组，每5点恰在1个区组中
- $S(5, 8, 24)$：24点，八元区组，每5点恰在1个区组中

重要性：
1. 自同构群是散在单群（sporadic simple groups）：
   - $S(5, 6, 12)$ 的自同构群是 Mathieu群 $M_{12}$
   - $S(5, 8, 24)$ 的自同构群是 Mathieu群 $M_{24}$
2. $M_{24}$ 是24维Leech格和怪物群（Monster）构造的关键
3. 与Golay码密切相关：
   - 扩展二元Golay码来自 $S(5, 8, 24)$
   - 扩展三元Golay码来自 $S(5, 6, 12)$
4. 在编码理论和组合设计中有重要应用

**答案**
Witt设计是 $S(5, 6, 12)$ 和 $S(5, 8, 24)$，其自同构群是Mathieu群 $M_{12}$ 和 $M_{24}$，在有限单群和编码理论中有核心地位。

---

**第8卷完**

*本卷涵盖组合设计的核心理论：设计理论基础、拉丁方及其正交性、正交数组构造、区组设计（BIBD）与可分解设计、以及Steiner系统与Witt设计。这些主题是组合数学中与代数、几何、编码理论深度交叉的重要领域。*
