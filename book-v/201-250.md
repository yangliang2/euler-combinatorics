# 欧拉组合数学系列 - 第5卷：递推关系 (201-250)

## 概述
本卷涵盖递推关系的核心内容，包括递推关系基础、线性递推、特征方程法、非齐次递推以及递推应用等主题。

---

## 题目 201 - 递推关系基础

**题目描述:**
已知数列 $\{a_n\}$ 满足递推关系 $a_n = 2a_{n-1} + 3$，且 $a_0 = 1$。求 $a_5$ 的值。

**解答过程:**

我们使用迭代法求解：

$$a_0 = 1$$

$$a_1 = 2a_0 + 3 = 2(1) + 3 = 5$$

$$a_2 = 2a_1 + 3 = 2(5) + 3 = 13$$

$$a_3 = 2a_2 + 3 = 2(13) + 3 = 29$$

$$a_4 = 2a_3 + 3 = 2(29) + 3 = 61$$

$$a_5 = 2a_4 + 3 = 2(61) + 3 = 125$$

**答案:** $a_5 = 125$

---

## 题目 202 - 线性递推

**题目描述:**
求满足递推关系 $a_n = 3a_{n-1} - 2a_{n-2}$，初始条件 $a_0 = 2, a_1 = 5$ 的数列通项公式。

**解答过程:**

特征方程为：
$$r^2 - 3r + 2 = 0$$
$$(r-1)(r-2) = 0$$

特征根为 $r_1 = 1, r_2 = 2$。

通解为 $a_n = A \cdot 1^n + B \cdot 2^n = A + B \cdot 2^n$

利用初始条件：
- $n=0$: $A + B = 2$
- $n=1$: $A + 2B = 5$

解得：$B = 3, A = -1$

**答案:** $a_n = -1 + 3 \cdot 2^n = 3 \cdot 2^n - 1$

---

## 题目 203 - 特征方程法

**题目描述:**
求解递推关系 $a_n = 5a_{n-1} - 6a_{n-2}$，其中 $a_0 = 1, a_1 = 4$。

**解答过程:**

特征方程：
$$r^2 - 5r + 6 = 0$$
$$(r-2)(r-3) = 0$$

特征根：$r_1 = 2, r_2 = 3$

通解：$a_n = A \cdot 2^n + B \cdot 3^n$

由初始条件：
- $A + B = 1$
- $2A + 3B = 4$

解得：$A = -1, B = 2$

**答案:** $a_n = 2 \cdot 3^n - 2^n$

---

## 题目 204 - 重根情况

**题目描述:**
求解递推关系 $a_n = 4a_{n-1} - 4a_{n-2}$，初始条件 $a_0 = 1, a_1 = 3$。

**解答过程:**

特征方程：
$$r^2 - 4r + 4 = 0$$
$$(r-2)^2 = 0$$

重根：$r = 2$ (二重根)

通解：$a_n = (A + Bn) \cdot 2^n$

由初始条件：
- $n=0$: $A = 1$
- $n=1$: $(A + B) \cdot 2 = 3$，即 $A + B = 1.5$

解得：$A = 1, B = 0.5$

**答案:** $a_n = (1 + \frac{n}{2}) \cdot 2^n = (2 + n) \cdot 2^{n-1}$

---

## 题目 205 - 非齐次递推

**题目描述:**
求解递推关系 $a_n = 2a_{n-1} + 3^n$，初始条件 $a_0 = 2$。

**解答过程:**

齐次解：$a_n^{(h)} = A \cdot 2^n$

特解形式：$a_n^{(p)} = B \cdot 3^n$ (因为 $3 \neq 2$)

代入原式：
$$B \cdot 3^n = 2B \cdot 3^{n-1} + 3^n$$
$$3B = 2B + 3$$
$$B = 3$$

通解：$a_n = A \cdot 2^n + 3 \cdot 3^n = A \cdot 2^n + 3^{n+1}$

由 $a_0 = 2$：$A + 3 = 2$，得 $A = -1$

**答案:** $a_n = 3^{n+1} - 2^n$

---

## 题目 206 - 斐波那契型递推

**题目描述:**
已知 $F_0 = 0, F_1 = 1$，且 $F_n = F_{n-1} + F_{n-2}$ 对于 $n \geq 2$。求 $F_{10}$ 及通项公式。

**解答过程:**

特征方程：$r^2 - r - 1 = 0$

特征根：$r = \frac{1 \pm \sqrt{5}}{2}$

记 $\phi = \frac{1+\sqrt{5}}{2}$ (黄金比例)，$\psi = \frac{1-\sqrt{5}}{2}$

通解：$F_n = A\phi^n + B\psi^n$

由初始条件：
- $A + B = 0$
- $A\phi + B\psi = 1$

解得：$A = \frac{1}{\sqrt{5}}, B = -\frac{1}{\sqrt{5}}$

$$F_n = \frac{\phi^n - \psi^n}{\sqrt{5}} = \frac{1}{\sqrt{5}}\left[\left(\frac{1+\sqrt{5}}{2}\right)^n - \left(\frac{1-\sqrt{5}}{2}\right)^n\right]$$

计算 $F_{10}$：$F_{10} = 55$

**答案:** $F_{10} = 55$，通项为比奈公式 $F_n = \frac{\phi^n - \psi^n}{\sqrt{5}}$

---

## 题目 207 - 三阶线性递推

**题目描述:**
求解递推关系 $a_n = 6a_{n-1} - 11a_{n-2} + 6a_{n-3}$，初始条件 $a_0 = 2, a_1 = 5, a_2 = 15$。

**解答过程:**

特征方程：
$$r^3 - 6r^2 + 11r - 6 = 0$$
$$(r-1)(r-2)(r-3) = 0$$

特征根：$r_1 = 1, r_2 = 2, r_3 = 3$

通解：$a_n = A \cdot 1^n + B \cdot 2^n + C \cdot 3^n = A + B \cdot 2^n + C \cdot 3^n$

由初始条件：
- $A + B + C = 2$
- $A + 2B + 3C = 5$
- $A + 4B + 9C = 15$

解得：$A = 0, B = -1, C = 3$

**答案:** $a_n = 3 \cdot 3^n - 2^n = 3^{n+1} - 2^n$

---

## 题目 208 - 复特征根

**题目描述:**
求解递推关系 $a_n = 2a_{n-1} - 2a_{n-2}$，初始条件 $a_0 = 1, a_1 = 2$。

**解答过程:**

特征方程：$r^2 - 2r + 2 = 0$

特征根：$r = \frac{2 \pm \sqrt{4-8}}{2} = 1 \pm i$

转换为极坐标：$|r| = \sqrt{2}, \theta = \frac{\pi}{4}$

$r = \sqrt{2}e^{\pm i\pi/4}$

通解：$a_n = (\sqrt{2})^n(A\cos\frac{n\pi}{4} + B\sin\frac{n\pi}{4})$

由初始条件：
- $A = 1$
- $\sqrt{2}(A\cos\frac{\pi}{4} + B\sin\frac{\pi}{4}) = 2$
- $\sqrt{2}(A \cdot \frac{1}{\sqrt{2}} + B \cdot \frac{1}{\sqrt{2}}) = 2$
- $A + B = 2$，得 $B = 1$

**答案:** $a_n = (\sqrt{2})^n(\cos\frac{n\pi}{4} + \sin\frac{n\pi}{4})$

---

## 题目 209 - 多项式非齐次项

**题目描述:**
求解递推关系 $a_n = 3a_{n-1} - 2a_{n-2} + 2n$，初始条件 $a_0 = 1, a_1 = 3$。

**解答过程:**

齐次解：$a_n^{(h)} = A \cdot 1^n + B \cdot 2^n = A + B \cdot 2^n$

特解形式：$a_n^{(p)} = Cn + D$

代入：
$$Cn + D = 3[C(n-1) + D] - 2[C(n-2) + D] + 2n$$
$$Cn + D = 3Cn - 3C + 3D - 2Cn + 4C - 2D + 2n$$
$$Cn + D = Cn + C + D + 2n$$

比较系数：
- $C = C + 2$ → 矛盾！

重设特解：$a_n^{(p)} = Cn^2 + Dn + E$

重新求解得：$C = -1, D = -3, E = -4$

通解：$a_n = A + B \cdot 2^n - n^2 - 3n - 4$

利用初始条件求出 $A, B$：
- $A + B - 4 = 1$，即 $A + B = 5$
- $A + 2B - 1 - 3 - 4 = 3$，即 $A + 2B = 11$

解得：$B = 6, A = -1$

**答案:** $a_n = 6 \cdot 2^n - n^2 - 3n - 5 = 3 \cdot 2^{n+1} - n^2 - 3n - 5$

---

## 题目 210 - 常系数非齐次

**题目描述:**
求解递推关系 $a_n = 4a_{n-1} - 4a_{n-2} + 2^n$，初始条件 $a_0 = 0, a_1 = 1$。

**解答过程:**

齐次解：特征根 $r = 2$ (二重)，$a_n^{(h)} = (A + Bn)2^n$

特解：因 $2^n$ 与齐次解重合，设 $a_n^{(p)} = Cn^2 \cdot 2^n$

代入求得 $C = \frac{1}{2}$

通解：$a_n = (A + Bn + \frac{n^2}{2})2^n$

由初始条件：
- $A = 0$
- $(B + \frac{1}{2}) \cdot 2 = 1$，得 $B = 0$

**答案:** $a_n = \frac{n^2}{2} \cdot 2^n = n^2 \cdot 2^{n-1}$

---

## 题目 211 - 汉诺塔问题

**题目描述:**
汉诺塔问题中，将 $n$ 个盘子从一根柱子移到另一根柱子所需的最少移动次数 $H_n$ 满足什么递推关系？并求解。

**解答过程:**

递推关系：$H_n = 2H_{n-1} + 1$，初始条件 $H_1 = 1$

求解：

齐次解：$H_n^{(h)} = A \cdot 2^n$

特解：设 $H_n^{(p)} = C$，代入得 $C = 2C + 1$，即 $C = -1$

通解：$H_n = A \cdot 2^n - 1$

由 $H_1 = 1$：$2A - 1 = 1$，得 $A = 1$

**答案:** $H_n = 2^n - 1$

---

## 题目 212 - 楼梯问题

**题目描述:**
上 $n$ 级楼梯，每次可以走1级或2级，求不同的上法数 $a_n$。

**解答过程:**

递推关系：$a_n = a_{n-1} + a_{n-2}$ (最后一步走1级或2级)

初始条件：$a_1 = 1, a_2 = 2$

这是斐波那契型递推，注意 $a_n = F_{n+1}$，其中 $F$ 是标准斐波那契数列。

**答案:** $a_n = F_{n+1} = \frac{1}{\sqrt{5}}\left[\left(\frac{1+\sqrt{5}}{2}\right)^{n+1} - \left(\frac{1-\sqrt{5}}{2}\right)^{n+1}\right]$

---

## 题目 213 - 分治递推

**题目描述:**
归并排序的时间复杂度满足 $T(n) = 2T(n/2) + n$，其中 $n = 2^k$。求解此递推关系。

**解答过程:**

设 $n = 2^k$，令 $a_k = T(2^k)$，则：

$a_k = 2a_{k-1} + 2^k$

齐次解：$a_k^{(h)} = A \cdot 2^k$

特解：设 $a_k^{(p)} = Bk \cdot 2^k$

代入：$Bk \cdot 2^k = 2B(k-1) \cdot 2^{k-1} + 2^k = B(k-1) \cdot 2^k + 2^k$

$Bk = B(k-1) + 1$，得 $B = 1$

通解：$a_k = A \cdot 2^k + k \cdot 2^k = (A + k)2^k$

若 $T(1) = 1$，则 $a_0 = 1$，$A = 1$

**答案:** $T(n) = n(\log_2 n + 1) = n\log_2 n + n = O(n\log n)$

---

## 题目 214 - 多重特征根

**题目描述:**
求解递推关系 $a_n = 6a_{n-1} - 12a_{n-2} + 8a_{n-3}$，初始条件 $a_0 = 1, a_1 = 0, a_2 = 4$。

**解答过程:**

特征方程：$r^3 - 6r^2 + 12r - 8 = 0$

$(r-2)^3 = 0$

三重根：$r = 2$

通解：$a_n = (A + Bn + Cn^2)2^n$

由初始条件：
- $A = 1$
- $(A + B + C) \cdot 2 = 0$，即 $A + B + C = 0$
- $(A + 2B + 4C) \cdot 4 = 4$，即 $A + 2B + 4C = 1$

解得：$A = 1, B = -3/2, C = 1/2$

**答案:** $a_n = (1 - \frac{3n}{2} + \frac{n^2}{2})2^n = (2 - 3n + n^2)2^{n-1}$

---

## 题目 215 - 变系数递推

**题目描述:**
求解递推关系 $a_n = na_{n-1}$，初始条件 $a_0 = 1$。

**解答过程:**

展开：
$$a_n = n \cdot a_{n-1} = n(n-1)a_{n-2} = n(n-1)(n-2)a_{n-3} = \cdots = n! \cdot a_0$$

**答案:** $a_n = n!$

---

## 题目 216 - 分式递推

**题目描述:**
求解递推关系 $a_n = \frac{a_{n-1}}{1 + a_{n-1}}$，初始条件 $a_0 = 1$。

**解答过程:**

令 $b_n = \frac{1}{a_n}$，则：

$$\frac{1}{b_n} = \frac{1/b_{n-1}}{1 + 1/b_{n-1}} = \frac{1}{b_{n-1} + 1}$$

所以 $b_n = b_{n-1} + 1$

这是等差数列：$b_n = b_0 + n = 1 + n$

因此 $a_n = \frac{1}{n+1}$

**答案:** $a_n = \frac{1}{n+1}$

---

## 题目 217 - 平方递推

**题目描述:**
求解递推关系 $a_n = a_{n-1}^2$，初始条件 $a_0 = 2$。

**解答过程:**

取对数：令 $b_n = \log_2 a_n$，则：

$$2^{b_n} = (2^{b_{n-1}})^2 = 2^{2b_{n-1}}$$

所以 $b_n = 2b_{n-1}$

$b_n = 2^n \cdot b_0 = 2^n \cdot 1 = 2^n$

因此 $a_n = 2^{2^n}$

**答案:** $a_n = 2^{2^n}$

---

## 题目 218 - 周期性递推

**题目描述:**
已知 $a_n = -a_{n-1}$，初始条件 $a_0 = 5$。求 $a_{100}$。

**解答过程:**

递推：
- $a_0 = 5$
- $a_1 = -5$
- $a_2 = 5$
- $a_3 = -5$

规律：$a_n = (-1)^n \cdot 5$

**答案:** $a_{100} = 5$

---

## 题目 219 - 三角函数递推

**题目描述:**
求解递推关系 $a_n = 2\cos\theta \cdot a_{n-1} - a_{n-2}$，初始条件 $a_0 = 0, a_1 = \sin\theta$。

**解答过程:**

特征方程：$r^2 - 2\cos\theta \cdot r + 1 = 0$

判别式：$4\cos^2\theta - 4 = -4\sin^2\theta$

特征根：$r = \cos\theta \pm i\sin\theta = e^{\pm i\theta}$

通解：$a_n = A\cos(n\theta) + B\sin(n\theta)$

由 $a_0 = 0$：$A = 0$

由 $a_1 = \sin\theta$：$B\sin\theta = \sin\theta$，得 $B = 1$

**答案:** $a_n = \sin(n\theta)$

---

## 题目 220 - 指数非齐次项

**题目描述:**
求解递推关系 $a_n = 5a_{n-1} - 6a_{n-2} + 4^n$，初始条件 $a_0 = 0, a_1 = 1$。

**解答过程:**

齐次解：$a_n^{(h)} = A \cdot 2^n + B \cdot 3^n$

特解：设 $a_n^{(p)} = C \cdot 4^n$

代入：$C \cdot 4^n = 5C \cdot 4^{n-1} - 6C \cdot 4^{n-2} + 4^n$

$16C = 20C - 6C + 16$，得 $C = 8$

通解：$a_n = A \cdot 2^n + B \cdot 3^n + 8 \cdot 4^{n-1} = A \cdot 2^n + B \cdot 3^n + 2 \cdot 4^n$

由初始条件：
- $A + B + 2 = 0$
- $2A + 3B + 8 = 1$

解得：$B = -5, A = 3$

**答案:** $a_n = 3 \cdot 2^n - 5 \cdot 3^n + 2 \cdot 4^n$

---

## 题目 221 - 组合数递推

**题目描述:**
证明递推关系 $\binom{n}{k} = \binom{n-1}{k} + \binom{n-1}{k-1}$，并用此计算 $\binom{10}{5}$。

**解答过程:**

证明：从 $n$ 个元素中选 $k$ 个，考虑某个特定元素：
- 不选该元素：$\binom{n-1}{k}$ 种
- 选该元素：$\binom{n-1}{k-1}$ 种

由加法原理得证。

计算 $\binom{10}{5}$：

利用递推构建帕斯卡三角形第11行：
$$1, 10, 45, 120, 210, 252, 210, 120, 45, 10, 1$$

**答案:** $\binom{10}{5} = 252$

---

## 题目 222 - 卡特兰数

**题目描述:**
卡特兰数 $C_n$ 满足递推关系 $C_n = \sum_{i=0}^{n-1} C_i C_{n-1-i}$，$C_0 = 1$。求 $C_5$。

**解答过程:**

逐项计算：
- $C_0 = 1$
- $C_1 = C_0 \cdot C_0 = 1$
- $C_2 = C_0C_1 + C_1C_0 = 1 + 1 = 2$
- $C_3 = C_0C_2 + C_1C_1 + C_2C_0 = 2 + 1 + 2 = 5$
- $C_4 = C_0C_3 + C_1C_2 + C_2C_1 + C_3C_0 = 5 + 2 + 2 + 5 = 14$
- $C_5 = C_0C_4 + C_1C_3 + C_2C_2 + C_3C_1 + C_4C_0 = 14 + 5 + 4 + 5 + 14 = 42$

**答案:** $C_5 = 42$

---

## 题目 223 - 错位排列

**题目描述:**
$n$ 个元素的错位排列数 $D_n$ 满足递推关系 $D_n = (n-1)(D_{n-1} + D_{n-2})$，$D_1 = 0, D_2 = 1$。求 $D_5$。

**解答过程:**

逐项计算：
- $D_1 = 0$
- $D_2 = 1$
- $D_3 = 2(D_2 + D_1) = 2(1 + 0) = 2$
- $D_4 = 3(D_3 + D_2) = 3(2 + 1) = 9$
- $D_5 = 4(D_4 + D_3) = 4(9 + 2) = 44$

**答案:** $D_5 = 44$

---

## 题目 224 - 错排公式

**题目描述:**
证明错位排列数也可表示为 $D_n = nD_{n-1} + (-1)^n$，并用此求 $D_6$。

**解答过程:**

证明：由 $D_n = (n-1)(D_{n-1} + D_{n-2})$

$D_n - nD_{n-1} = (n-1)D_{n-2} - D_{n-1}$

利用 $D_{n-1} = (n-2)(D_{n-2} + D_{n-3})$，经过推导可得：

$D_n = nD_{n-1} + (-1)^n$

验证：
- $D_1 = 0$
- $D_2 = 2 \cdot 0 + 1 = 1$ ✓
- $D_3 = 3 \cdot 1 - 1 = 2$ ✓

求 $D_6$：
$$D_6 = 6D_5 + 1 = 6 \cdot 44 + 1 = 265$$

**答案:** $D_6 = 265$

---

## 题目 225 - 卡塔兰数显式公式

**题目描述:**
证明卡特兰数的显式公式 $C_n = \frac{1}{n+1}\binom{2n}{n}$，并验证 $n=3$ 时 $C_3 = 5$。

**解答过程:**

证明：设生成函数 $C(x) = \sum_{n=0}^{\infty} C_n x^n$

由递推 $C_n = \sum_{i=0}^{n-1} C_i C_{n-1-i}$（$n \geq 1$），$C_0 = 1$

$$C(x) = 1 + x\sum_{n=1}^{\infty}\sum_{i=0}^{n-1} C_i C_{n-1-i} x^{n-1} = 1 + xC(x)^2$$

解方程 $xC^2 - C + 1 = 0$：

$$C(x) = \frac{1 - \sqrt{1-4x}}{2x}$$

展开 $(1-4x)^{1/2}$：
$$C_n = \frac{1}{n+1}\binom{2n}{n}$$

验证：$C_3 = \frac{1}{4}\binom{6}{3} = \frac{20}{4} = 5$ ✓

**答案:** 公式成立，$C_3 = 5$

---

## 题目 226 - 二阶非齐次特殊形式

**题目描述:**
求解递推关系 $a_n = 3a_{n-1} - 2a_{n-2} + 2^n$，初始条件 $a_0 = 2, a_1 = 5$。

**解答过程:**

齐次解：特征根 $r = 1, 2$，$a_n^{(h)} = A + B \cdot 2^n$

特解：由于 $2^n$ 与齐次解中的 $B \cdot 2^n$ 重合，设 $a_n^{(p)} = Cn \cdot 2^n$

代入：$Cn \cdot 2^n = 3C(n-1)2^{n-1} - 2C(n-2)2^{n-2} + 2^n$

除以 $2^{n-2}$：$4Cn = 6C(n-1) - 2C(n-2) + 4$

$4Cn = 6Cn - 6C - 2Cn + 4C + 4$

$4Cn = 4Cn - 2C + 4$，得 $C = 2$

通解：$a_n = A + B \cdot 2^n + 2n \cdot 2^n = A + (B + 2n)2^n$

由初始条件：
- $A + B = 2$
- $A + 2(B + 2) = 5$，即 $A + 2B = 1$

解得：$A = 3, B = -1$

**答案:** $a_n = 3 + (2n - 1)2^n$

---

## 题目 227 - 带参数递推

**题目描述:**
求解递推关系 $a_n = pa_{n-1} + qa_{n-2}$，其中 $p^2 + 4q > 0$，初始条件 $a_0 = 0, a_1 = 1$。

**解答过程:**

特征方程：$r^2 - pr - q = 0$

特征根：$r = \frac{p \pm \sqrt{p^2 + 4q}}{2}$

记 $\Delta = \sqrt{p^2 + 4q}$，则 $r_1 = \frac{p + \Delta}{2}, r_2 = \frac{p - \Delta}{2}$

通解：$a_n = Ar_1^n + Br_2^n$

由初始条件：
- $A + B = 0$，即 $B = -A$
- $Ar_1 + Br_2 = 1$，即 $A(r_1 - r_2) = 1$

$r_1 - r_2 = \Delta$，所以 $A = \frac{1}{\Delta}, B = -\frac{1}{\Delta}$

**答案:** $a_n = \frac{1}{\sqrt{p^2+4q}}\left[\left(\frac{p+\sqrt{p^2+4q}}{2}\right)^n - \left(\frac{p-\sqrt{p^2+4q}}{2}\right)^n\right]$

---

## 题目 228 - 卢卡斯数

**题目描述:**
卢卡斯数 $L_n$ 满足 $L_n = L_{n-1} + L_{n-2}$，$L_0 = 2, L_1 = 1$。求通项公式及 $L_{10}$。

**解答过程:**

与斐波那契相同特征方程，特征根 $\phi = \frac{1+\sqrt{5}}{2}, \psi = \frac{1-\sqrt{5}}{2}$

通解：$L_n = A\phi^n + B\psi^n$

由初始条件：
- $A + B = 2$
- $A\phi + B\psi = 1$

解得：$A = B = 1$

$L_{10} = \phi^{10} + \psi^{10} = \frac{1}{2^{10}}[(1+\sqrt{5})^{10} + (1-\sqrt{5})^{10}]$

计算得 $L_{10} = 123$

**答案:** $L_n = \phi^n + \psi^n$，$L_{10} = 123$

---

## 题目 229 - 斐波那契恒等式

**题目描述:**
证明 $F_0 + F_1 + F_2 + \cdots + F_n = F_{n+2} - 1$。

**解答过程:**

用数学归纳法或递推法：

由 $F_k = F_{k+2} - F_{k+1}$（变形递推式）：

$$\sum_{k=0}^{n} F_k = \sum_{k=0}^{n} (F_{k+2} - F_{k+1})$$

这是望远镜求和：
$$= (F_2 - F_1) + (F_3 - F_2) + \cdots + (F_{n+2} - F_{n+1})$$
$$= F_{n+2} - F_1 = F_{n+2} - 1$$

**答案:** 恒等式成立

---

## 题目 230 - 斐波那契比

**题目描述:**
证明 $\lim_{n \to \infty} \frac{F_{n+1}}{F_n} = \phi = \frac{1+\sqrt{5}}{2}$。

**解答过程:**

由比奈公式：$F_n = \frac{\phi^n - \psi^n}{\sqrt{5}}$

$$\frac{F_{n+1}}{F_n} = \frac{\phi^{n+1} - \psi^{n+1}}{\phi^n - \psi^n} = \frac{\phi - \psi(\psi/\phi)^n}{1 - (\psi/\phi)^n}$$

由于 $|\psi| < |\phi|$，所以 $|\psi/\phi| < 1$

当 $n \to \infty$ 时，$(\psi/\phi)^n \to 0$

**答案:** $\lim_{n \to \infty} \frac{F_{n+1}}{F_n} = \phi = \frac{1+\sqrt{5}}{2} \approx 1.618$

---

## 题目 231 - 连分数与递推

**题目描述:**
设 $a_n$ 为连分数 $[1; 1, 1, \ldots, 1]$（$n$ 个1）的值，求 $a_n$ 的递推关系及通项。

**解答过程:**

连分数定义：$a_n = 1 + \frac{1}{a_{n-1}}$，$a_1 = 1$

展开：
- $a_1 = 1$
- $a_2 = 1 + 1 = 2$
- $a_3 = 1 + 1/2 = 3/2$
- $a_4 = 1 + 2/3 = 5/3$

规律：分子分母都是斐波那契数，$a_n = \frac{F_{n+1}}{F_n}$

**答案:** $a_n = \frac{F_{n+1}}{F_n}$，其中 $F_n$ 是斐波那契数

---

## 题目 232 - 矩阵递推

**题目描述:**
设向量 $\mathbf{v}_n = \begin{pmatrix} F_{n+1} \\ F_n \end{pmatrix}$，求矩阵 $A$ 使得 $\mathbf{v}_n = A\mathbf{v}_{n-1}$，并求 $A^n$。

**解答过程:**

由斐波那契递推：
$$F_{n+1} = F_n + F_{n-1}$$
$$F_n = F_n$$

所以：
$$\begin{pmatrix} F_{n+1} \\ F_n \end{pmatrix} = \begin{pmatrix} 1 & 1 \\ 1 & 0 \end{pmatrix} \begin{pmatrix} F_n \\ F_{n-1} \end{pmatrix}$$

$A = \begin{pmatrix} 1 & 1 \\ 1 & 0 \end{pmatrix}$

$A^n = \begin{pmatrix} F_{n+1} & F_n \\ F_n & F_{n-1} \end{pmatrix}$（可用归纳法证明）

**答案:** $A = \begin{pmatrix} 1 & 1 \\ 1 & 0 \end{pmatrix}$，$A^n = \begin{pmatrix} F_{n+1} & F_n \\ F_n & F_{n-1} \end{pmatrix}$

---

## 题目 233 - 多步递推

**题目描述:**
求解递推关系 $a_n = a_{n-1} + a_{n-2} + a_{n-3}$，初始条件 $a_0 = 0, a_1 = 1, a_2 = 1$（Tribonacci数）。求 $a_8$。

**解答过程:**

逐项计算：
- $a_3 = 1 + 1 + 0 = 2$
- $a_4 = 2 + 1 + 1 = 4$
- $a_5 = 4 + 2 + 1 = 7$
- $a_6 = 7 + 4 + 2 = 13$
- $a_7 = 13 + 7 + 4 = 24$
- $a_8 = 24 + 13 + 7 = 44$

**答案:** $a_8 = 44$

---

## 题目 234 - 多变量递推

**题目描述:**
设 $a_n = 2a_{n-1} + b_{n-1}$，$b_n = a_{n-1} + 2b_{n-1}$，初始条件 $a_0 = 1, b_0 = 0$。求 $a_n + b_n$。

**解答过程:**

令 $s_n = a_n + b_n$，$d_n = a_n - b_n$

$s_n = 2a_{n-1} + b_{n-1} + a_{n-1} + 2b_{n-1} = 3(a_{n-1} + b_{n-1}) = 3s_{n-1}$

$d_n = 2a_{n-1} + b_{n-1} - a_{n-1} - 2b_{n-1} = a_{n-1} - b_{n-1} = d_{n-1}$

$s_0 = 1, d_0 = 1$

所以 $s_n = 3^n$，$d_n = 1$

**答案:** $a_n + b_n = 3^n$

---

## 题目 235 - 二项式变换

**题目描述:**
若 $b_n = \sum_{k=0}^{n} \binom{n}{k} a_k$，证明 $a_n = \sum_{k=0}^{n} (-1)^{n-k}\binom{n}{k} b_k$（二项式反演）。

**解答过程:**

证明：利用生成函数或组合论证。

设 $A(x) = \sum a_n \frac{x^n}{n!}$，$B(x) = \sum b_n \frac{x^n}{n!}$

$b_n = \sum \binom{n}{k} a_k$ 是二项式卷积

$B(x) = A(x) e^x$，所以 $A(x) = B(x)e^{-x}$

$a_n = \sum_{k=0}^{n} \binom{n}{k} b_k (-1)^{n-k}$

**答案:** 二项式反演公式成立

---

## 题目 236 - 斯特林数递推

**题目描述:**
第一类斯特林数 $c(n,k)$ 满足递推 $c(n,k) = c(n-1,k-1) + (n-1)c(n-1,k)$，边界 $c(n,0) = 0$（$n>0$），$c(0,0) = 1$。求 $c(5,2)$。

**解答过程:**

递推表：

$n=0$：$c(0,0) = 1$

$n=1$：$c(1,1) = c(0,0) + 0 = 1$

$n=2$：$c(2,1) = c(1,0) + 1 \cdot c(1,1) = 0 + 1 = 1$
$c(2,2) = c(1,1) + 1 \cdot c(1,2) = 1 + 0 = 1$

$n=3$：$c(3,1) = 2$，$c(3,2) = 3$，$c(3,3) = 1$

$n=4$：$c(4,1) = 6$，$c(4,2) = 11$，$c(4,3) = 6$，$c(4,4) = 1$

$n=5$：$c(5,2) = c(4,1) + 4c(4,2) = 6 + 4 \cdot 11 = 6 + 44 = 50$

**答案:** $c(5,2) = 50$

---

## 题目 237 - 第二类斯特林数

**题目描述:**
第二类斯特林数 $S(n,k)$ 满足 $S(n,k) = S(n-1,k-1) + kS(n-1,k)$，边界 $S(0,0) = 1$，$S(n,0) = 0$（$n>0$）。求 $S(5,3)$。

**解答过程:**

递推表：

$n=1$：$S(1,1) = 1$

$n=2$：$S(2,1) = 1$，$S(2,2) = 1$

$n=3$：$S(3,1) = 1$，$S(3,2) = 3$，$S(3,3) = 1$

$n=4$：$S(4,1) = 1$，$S(4,2) = 7$，$S(4,3) = 6$，$S(4,4) = 1$

$n=5$：
- $S(5,1) = 1$
- $S(5,2) = S(4,1) + 2S(4,2) = 1 + 14 = 15$
- $S(5,3) = S(4,2) + 3S(4,3) = 7 + 18 = 25$

**答案:** $S(5,3) = 25$

---

## 题目 238 - 贝尔数

**题目描述:**
贝尔数 $B_n$ 表示 $n$ 元集合的划分数，满足 $B_n = \sum_{k=0}^{n-1} \binom{n-1}{k} B_k$，$B_0 = 1$。求 $B_4$。

**解答过程:**

计算：
- $B_0 = 1$
- $B_1 = \binom{0}{0}B_0 = 1$
- $B_2 = \binom{1}{0}B_0 + \binom{1}{1}B_1 = 1 + 1 = 2$
- $B_3 = \binom{2}{0}B_0 + \binom{2}{1}B_1 + \binom{2}{2}B_2 = 1 + 2 + 2 = 5$
- $B_4 = \binom{3}{0}B_0 + \binom{3}{1}B_1 + \binom{3}{2}B_2 + \binom{3}{3}B_3$

$= 1 + 3 + 3 \cdot 2 + 5 = 1 + 3 + 6 + 5 = 15$

**答案:** $B_4 = 15$

---

## 题目 239 - 调和数递推

**题目描述:**
调和数 $H_n = 1 + \frac{1}{2} + \cdots + \frac{1}{n}$ 满足什么递推关系？

**解答过程:**

由定义：$H_n = H_{n-1} + \frac{1}{n}$，$H_0 = 0$ 或 $H_1 = 1$

这是简单的累积递推。

**答案:** $H_n = H_{n-1} + \frac{1}{n}$

---

## 题目 240 - 伯努利数

**题目描述:**
伯努利数 $B_n$ 满足 $\sum_{k=0}^{n} \binom{n+1}{k} B_k = 0$（$n \geq 1$），$B_0 = 1$。求 $B_1, B_2, B_3, B_4$。

**解答过程:**

$n=1$：$\binom{2}{0}B_0 + \binom{2}{1}B_1 = 0$

$1 + 2B_1 = 0$，$B_1 = -\frac{1}{2}$

$n=2$：$\binom{3}{0}B_0 + \binom{3}{1}B_1 + \binom{3}{2}B_2 = 0$

$1 + 3(-\frac{1}{2}) + 3B_2 = 0$

$1 - \frac{3}{2} + 3B_2 = 0$，$B_2 = \frac{1}{6}$

$n=3$：$1 + 4(-\frac{1}{2}) + 6(\frac{1}{6}) + 4B_3 = 0$

$1 - 2 + 1 + 4B_3 = 0$，$B_3 = 0$

$n=4$：$1 + 5(-\frac{1}{2}) + 10(\frac{1}{6}) + 10(0) + 5B_4 = 0$

$1 - \frac{5}{2} + \frac{5}{3} + 5B_4 = 0$

$B_4 = -\frac{1}{30}$

**答案:** $B_1 = -\frac{1}{2}, B_2 = \frac{1}{6}, B_3 = 0, B_4 = -\frac{1}{30}$

---

## 题目 241 - 整值多项式

**题目描述:**
证明数列 $a_n = n^k$ 满足 $k+1$ 阶线性递推关系。

**解答过程:**

由有限差分理论，$k$ 次多项式的 $k+1$ 阶差分为0。

$$\Delta^{k+1} n^k = 0$$

展开得线性递推：
$$\sum_{j=0}^{k+1} (-1)^{k+1-j}\binom{k+1}{j} (n+j)^k = 0$$

对固定的 $k$，这是关于 $n$ 的线性递推。

**答案:** 数列 $n^k$ 满足 $\sum_{j=0}^{k+1} (-1)^{k+1-j}\binom{k+1}{j} a_{n+j} = 0$

---

## 题目 242 - 幂和公式

**题目描述:**
利用递推求 $S_k(n) = 1^k + 2^k + \cdots + n^k$ 满足的关系。

**解答过程:**

显然：$S_k(n) = S_k(n-1) + n^k$

这是关于 $S_k(n)$ 的非齐次递推。

也可用伯努利多项式：$S_k(n) = \frac{1}{k+1}\sum_{j=0}^{k} \binom{k+1}{j} B_j n^{k+1-j}$

**答案:** $S_k(n) = S_k(n-1) + n^k$

---

## 题目 243 - 递推系统

**题目描述:**
求解递推系统：
$$a_n = 3a_{n-1} + 2b_{n-1}$$
$$b_n = 2a_{n-1} + 3b_{n-1}$$
初始条件 $a_0 = 1, b_0 = 0$。

**解答过程:**

令 $s_n = a_n + b_n$，$d_n = a_n - b_n$

$s_n = 5s_{n-1}$，$s_0 = 1$，所以 $s_n = 5^n$

$d_n = d_{n-1}$，$d_0 = 1$，所以 $d_n = 1$

$a_n = \frac{s_n + d_n}{2} = \frac{5^n + 1}{2}$

$b_n = \frac{s_n - d_n}{2} = \frac{5^n - 1}{2}$

**答案:** $a_n = \frac{5^n + 1}{2}$，$b_n = \frac{5^n - 1}{2}$

---

## 题目 244 - 分式线性递推

**题目描述:**
求解递推关系 $a_{n+1} = \frac{2a_n + 1}{a_n + 2}$，$a_0 = 0$。

**解答过程:**

设不动点：$x = \frac{2x+1}{x+2}$，$x^2 + 2x = 2x + 1$，$x^2 = 1$，$x = \pm 1$

令 $b_n = \frac{a_n - 1}{a_n + 1}$，则：

$$b_{n+1} = \frac{a_{n+1} - 1}{a_{n+1} + 1} = \frac{\frac{2a_n+1}{a_n+2} - 1}{\frac{2a_n+1}{a_n+2} + 1} = \frac{a_n - 1}{3a_n + 3} = \frac{1}{3}b_n$$

$b_n = b_0 \cdot (1/3)^n = (-1) \cdot 3^{-n}$

由 $b_n = \frac{a_n - 1}{a_n + 1}$，解得：

$a_n = \frac{1 + b_n}{1 - b_n} = \frac{1 - 3^{-n}}{1 + 3^{-n}} = \frac{3^n - 1}{3^n + 1}$

**答案:** $a_n = \frac{3^n - 1}{3^n + 1}$

---

## 题目 245 - 乘法递推

**题目描述:**
设 $a_n = a_{n-1} \cdot a_{n-2}$，$a_0 = 2, a_1 = 3$。求 $a_6$。

**解答过程:**

逐项计算：
- $a_0 = 2$
- $a_1 = 3$
- $a_2 = 2 \cdot 3 = 6$
- $a_3 = 3 \cdot 6 = 18$
- $a_4 = 6 \cdot 18 = 108$
- $a_5 = 18 \cdot 108 = 1944$
- $a_6 = 108 \cdot 1944 = 209952$

**答案:** $a_6 = 209952$

---

## 题目 246 - 带模递推

**题目描述:**
斐波那契数列模 $m$ 是否周期？若是，求模 $5$ 的周期。

**解答过程:**

皮萨诺周期定理：斐波那契数列模 $m$ 是周期数列。

计算模5：
- $F_0 \equiv 0$
- $F_1 \equiv 1$
- $F_2 \equiv 1$
- $F_3 \equiv 2$
- $F_4 \equiv 3$
- $F_5 \equiv 0$
- $F_6 \equiv 3$
- $F_7 \equiv 3$
- $F_8 \equiv 1$
- $F_9 \equiv 4$
- $F_{10} \equiv 0$
- $F_{11} \equiv 4$
- $F_{12} \equiv 4$
- $F_{13} \equiv 3$
- $F_{14} \equiv 2$
- $F_{15} \equiv 0$
- $F_{16} \equiv 2$
- $F_{17} \equiv 2$
- $F_{18} \equiv 4$
- $F_{19} \equiv 1$
- $F_{20} \equiv 0$
- $F_{21} \equiv 1 = F_1$，出现 $(0,1)$

**答案:** 模5的周期为20

---

## 题目 247 - 递推估计

**题目描述:**
设 $a_n = \sqrt{2 + a_{n-1}}$，$a_0 = 0$。证明数列收敛并求极限。

**解答过程:**

单调性：归纳证明 $a_n < a_{n+1} < 2$
- $a_0 = 0 < \sqrt{2} = a_1 < 2$ ✓
- 若 $a_{n-1} < a_n < 2$，则 $a_n = \sqrt{2+a_{n-1}} < \sqrt{2+a_n} = a_{n+1} < \sqrt{4} = 2$

有界单调数列必收敛。

设极限为 $L$：$L = \sqrt{2+L}$

$L^2 = 2 + L$，$L^2 - L - 2 = 0$

$(L-2)(L+1) = 0$，$L = 2$（舍去负根）

**答案:** 极限为 $2$

---

## 题目 248 - 双重递推

**题目描述:**
设 $a_{m,n} = a_{m-1,n} + a_{m,n-1}$，边界 $a_{0,n} = a_{m,0} = 1$。求 $a_{m,n}$。

**解答过程:**

这是组合数递推。

由边界和传播规则，$a_{m,n}$ 等于从 $(0,0)$ 到 $(m,n)$ 的格路数，每步向右或向上。

$$a_{m,n} = \binom{m+n}{m} = \binom{m+n}{n}$$

验证：
- $a_{0,n} = \binom{n}{0} = 1$ ✓
- $a_{m,0} = \binom{m}{m} = 1$ ✓
- 递推：$\binom{m+n}{m} = \binom{m+n-1}{m-1} + \binom{m+n-1}{m}$ 是帕斯卡法则 ✓

**答案:** $a_{m,n} = \binom{m+n}{m}$

---

## 题目 249 - 渐近分析

**题目描述:**
估计 $n$ 阶错位排列数 $D_n$ 的渐近行为。

**解答过程:**

由公式 $D_n = n! \sum_{k=0}^{n} \frac{(-1)^k}{k!}$

当 $n \to \infty$：
$$\sum_{k=0}^{n} \frac{(-1)^k}{k!} \to e^{-1} = \frac{1}{e}$$

所以 $D_n \sim \frac{n!}{e}$

更精确：$D_n = \left\lfloor \frac{n!}{e} + \frac{1}{2} \right\rfloor$

**答案:** $D_n \sim \frac{n!}{e}$

---

## 题目 250 - 主定理

**题目描述:**
叙述并应用主定理：求解 $T(n) = 2T(n/2) + n\log n$。

**解答过程:**

**主定理**：对 $T(n) = aT(n/b) + f(n)$，$a \geq 1, b > 1$：

1. 若 $f(n) = O(n^{\log_b a - \epsilon})$，则 $T(n) = \Theta(n^{\log_b a})$
2. 若 $f(n) = \Theta(n^{\log_b a})$，则 $T(n) = \Theta(n^{\log_b a} \log n)$
3. 若 $f(n) = \Omega(n^{\log_b a + \epsilon})$ 且正则条件成立，则 $T(n) = \Theta(f(n))$

本题：$a=2, b=2$，$n^{\log_2 2} = n$

$f(n) = n\log n = \omega(n)$ 但不满足多项式大于关系。

使用扩展方法或迭代：

设 $n = 2^k$，$a_k = T(2^k)$

$a_k = 2a_{k-1} + k \cdot 2^k$

解得 $a_k = 2^k \cdot \frac{k(k+1)}{2} = n \cdot \frac{\log_2 n (\log_2 n + 1)}{2}$

**答案:** $T(n) = \Theta(n\log^2 n)$

---

## 总结

本卷共50道题目，涵盖了递推关系的核心内容：

| 主题 | 题号范围 | 主要内容 |
|------|----------|----------|
| 递推关系基础 | 201-205 | 迭代法、基本递推求解 |
| 线性递推 | 206-210 | 齐次线性递推、特征方程 |
| 特征方程法 | 211-215 | 重根、复根、高阶递推 |
| 非齐次递推 | 216-220 | 特解法、待定系数 |
| 经典数列 | 221-230 | 斐波那契、卢卡斯、卡塔兰数 |
| 组合数列 | 231-240 | 斯特林数、贝尔数、伯努利数 |
| 递推应用 | 241-250 | 系统递推、渐近分析、主定理 |

递推关系是组合数学的重要工具，掌握各种求解方法对解决计数问题至关重要。
